#!/usr/bin/env python
import sys
import pilot

if __name__ == '__main__':
    args = {}
    target = None

    last = None
    for arg in sys.argv[1:]:
        if last:
            args[last] = arg
            last = None
        elif arg[0] == '-':
            last = arg[1:]
        elif not target:
            target = arg
        else:
            sys.stderr.write("Don't know how to deal with argument: %s\n" % arg)
            sys.exit(1)

    b = pilot.Pilotfile(args['f'] if 'f' in args else None, args)
    pipe = b.build(target)
    pipe.run(args)
